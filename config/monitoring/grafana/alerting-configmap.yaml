apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-alerting-provisioning
  namespace: monitoring
data:
  contact-points.yaml: |
    apiVersion: 1
    contactPoints:
      - orgId: 1
        name: slack-default
        receivers:
          - uid: slack-default
            type: slack
            settings:
              url: ${SLACK_WEBHOOK_URL}
              recipient: "#alerts"
  notification-policies.yaml: |
    apiVersion: 1
    policies:
      - orgId: 1
        receiver: slack-default
        group_by: [alertname]
        routes: []
  rules.yaml: |
    apiVersion: 1
    groups:
      - orgId: 1
        name: sample-group
        folder: "Ops"
        interval: 1m
        rules:
          - uid: sample-always-firing
            title: AlwaysFiring
            condition: A
            data:
              - refId: A
                datasourceUid: prometheus
                relativeTimeRange: { from: 300, to: 0 }
                model:
                  expr: vector(1)
                  instant: true
                  intervalMs: 1000
                  maxDataPoints: 43200
                  refId: A
                  datasource: { type: prometheus, uid: prometheus }
            noDataState: Alerting
            execErrState: Alerting
            for: 1m